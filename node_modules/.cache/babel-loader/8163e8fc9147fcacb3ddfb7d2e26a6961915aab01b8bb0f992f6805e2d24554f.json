{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\OneDrive\\\\Desktop\\\\cht\\\\client\\\\src\\\\components\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from \"react\";\nimport socket from \"../socket\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport API from \"../api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const {\n    user\n  } = useContext(AuthContext);\n  const [friends, setFriends] = useState([]);\n  const [receiverId, setReceiverId] = useState(\"\"); // friend id\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n\n  // JOIN ROOM\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user._id) {\n      socket.emit(\"join\", user._id);\n    }\n  }, [user]);\n\n  // FETCH FRIENDS\n  useEffect(() => {\n    const fetchFriends = async () => {\n      try {\n        const res = await API.get(\"/users\", {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        setFriends(res.data);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n    fetchFriends();\n  }, []);\n\n  // RECEIVE MESSAGES\n  useEffect(() => {\n    socket.on(\"receiveMessage\", msg => {\n      setMessages(prev => [...prev, msg]);\n    });\n    return () => socket.off(\"receiveMessage\");\n  }, []);\n\n  // SEND MESSAGE\n  const sendMessage = () => {\n    if (!receiverId || !message) return;\n    socket.emit(\"sendMessage\", {\n      senderId: user._id,\n      receiverId,\n      text: message\n    });\n    setMessages(prev => [...prev, {\n      senderId: user._id,\n      text: message\n    }]);\n    setMessage(\"\");\n  };\n\n  // SELECT FRIEND\n  const selectFriend = id => {\n    setReceiverId(id);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Welcome, \", user === null || user === void 0 ? void 0 : user.username]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Your User ID: \", /*#__PURE__*/_jsxDEV(\"code\", {\n        children: user === null || user === void 0 ? void 0 : user._id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 24\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Friends\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: friends.map(f => /*#__PURE__*/_jsxDEV(\"li\", {\n        onClick: () => selectFriend(f._id),\n        children: [f.username, \" \\u2014 \", /*#__PURE__*/_jsxDEV(\"code\", {\n          children: f._id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 28\n        }, this)]\n      }, f._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [\"Chat \", receiverId ? `(to ${receiverId})` : \"\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-box\",\n      children: messages.map((m, i) => /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: [m.senderId === user._id ? \"You\" : \"Friend\", \":\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this), \" \", m.text]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      value: message,\n      onChange: e => setMessage(e.target.value),\n      placeholder: \"Type message...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: sendMessage,\n      children: \"Send\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"HJyoOwfbKT1TIKSMzrPI4scr550=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["useContext","useEffect","useState","socket","AuthContext","API","jsxDEV","_jsxDEV","Chat","_s","user","friends","setFriends","receiverId","setReceiverId","message","setMessage","messages","setMessages","_id","emit","fetchFriends","res","get","headers","Authorization","localStorage","getItem","data","err","console","error","on","msg","prev","off","sendMessage","senderId","text","selectFriend","id","className","children","username","fileName","_jsxFileName","lineNumber","columnNumber","map","f","onClick","m","i","value","onChange","e","target","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/user/OneDrive/Desktop/cht/client/src/components/Chat.jsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport socket from \"../socket\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport API from \"../api\";\r\n\r\nexport default function Chat() {\r\n  const { user } = useContext(AuthContext);\r\n  const [friends, setFriends] = useState([]);\r\n  const [receiverId, setReceiverId] = useState(\"\"); // friend id\r\n  const [message, setMessage] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  // JOIN ROOM\r\n  useEffect(() => {\r\n    if (user?._id) {\r\n      socket.emit(\"join\", user._id);\r\n    }\r\n  }, [user]);\r\n\r\n  // FETCH FRIENDS\r\n  useEffect(() => {\r\n    const fetchFriends = async () => {\r\n      try {\r\n        const res = await API.get(\"/users\", {\r\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` }\r\n        });\r\n        setFriends(res.data);\r\n      } catch (err) {\r\n        console.error(err);\r\n      }\r\n    };\r\n    fetchFriends();\r\n  }, []);\r\n\r\n  // RECEIVE MESSAGES\r\n  useEffect(() => {\r\n    socket.on(\"receiveMessage\", (msg) => {\r\n      setMessages(prev => [...prev, msg]);\r\n    });\r\n\r\n    return () => socket.off(\"receiveMessage\");\r\n  }, []);\r\n\r\n  // SEND MESSAGE\r\n  const sendMessage = () => {\r\n    if (!receiverId || !message) return;\r\n\r\n    socket.emit(\"sendMessage\", {\r\n      senderId: user._id,\r\n      receiverId,\r\n      text: message\r\n    });\r\n\r\n    setMessages(prev => [\r\n      ...prev,\r\n      { senderId: user._id, text: message }\r\n    ]);\r\n\r\n    setMessage(\"\");\r\n  };\r\n\r\n  // SELECT FRIEND\r\n  const selectFriend = (id) => {\r\n    setReceiverId(id);\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-container\">\r\n      <h2>Welcome, {user?.username}</h2>\r\n      <p>Your User ID: <code>{user?._id}</code></p>\r\n\r\n      <h3>Friends</h3>\r\n      <ul>\r\n        {friends.map(f => (\r\n          <li key={f._id} onClick={() => selectFriend(f._id)}>\r\n            {f.username} â€” <code>{f._id}</code>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n\r\n      <h3>Chat {receiverId ? `(to ${receiverId})` : \"\"}</h3>\r\n      <div className=\"chat-box\">\r\n        {messages.map((m, i) => (\r\n          <p key={i}>\r\n            <b>{m.senderId === user._id ? \"You\" : \"Friend\"}:</b> {m.text}\r\n          </p>\r\n        ))}\r\n      </div>\r\n\r\n      <input\r\n        value={message}\r\n        onChange={e => setMessage(e.target.value)}\r\n        placeholder=\"Type message...\"\r\n      />\r\n      <button onClick={sendMessage}>Send</button>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}