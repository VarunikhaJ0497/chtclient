{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\OneDrive\\\\Desktop\\\\cht\\\\client\\\\src\\\\components\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from \"react\";\nimport socket from \"../socket\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport API from \"../api\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const {\n    user\n  } = useContext(AuthContext);\n  const [friends, setFriends] = useState([]);\n  const [currentFriend, setCurrentFriend] = useState(null);\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState({}); // ðŸ‘ˆ per friend\n\n  // JOIN SOCKET ROOM\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user._id) {\n      socket.emit(\"join\", user._id);\n    }\n  }, [user]);\n\n  // RECEIVE MESSAGE\n  useEffect(() => {\n    socket.on(\"receiveMessage\", ({\n      senderId,\n      text\n    }) => {\n      setMessages(prev => ({\n        ...prev,\n        [senderId]: [...(prev[senderId] || []), {\n          senderId,\n          text\n        }]\n      }));\n    });\n    return () => socket.off(\"receiveMessage\");\n  }, []);\n\n  // FETCH FRIENDS\n  useEffect(() => {\n    const fetchFriends = async () => {\n      const res = await API.get(\"/users\", {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setFriends(res.data);\n    };\n    fetchFriends();\n  }, []);\n\n  // SEND MESSAGE\n  const sendMessage = () => {\n    if (!currentFriend || !message) return;\n    socket.emit(\"sendMessage\", {\n      senderId: user._id,\n      receiverId: currentFriend._id,\n      text: message\n    });\n    setMessages(prev => ({\n      ...prev,\n      [currentFriend._id]: [...(prev[currentFriend._id] || []), {\n        senderId: user._id,\n        text: message\n      }]\n    }));\n    setMessage(\"\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\",\n      height: \"90vh\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"30%\",\n        borderRight: \"1px solid #ccc\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: user.username\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), friends.map(f => /*#__PURE__*/_jsxDEV(\"p\", {\n        onClick: () => setCurrentFriend(f),\n        style: {\n          cursor: \"pointer\",\n          background: (currentFriend === null || currentFriend === void 0 ? void 0 : currentFriend._id) === f._id ? \"#eee\" : \"transparent\"\n        },\n        children: f.username\n      }, f._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"70%\",\n        padding: \"10px\"\n      },\n      children: currentFriend ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Chat with \", currentFriend.username]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: \"70vh\",\n            overflowY: \"auto\"\n          },\n          children: (messages[currentFriend._id] || []).map((m, i) => /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: [m.senderId === user._id ? \"You\" : currentFriend.username, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 19\n            }, this), \" \", m.text]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          placeholder: \"Type message...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: sendMessage,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Select a friend to start chatting\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"8w8smV7NPQX3sgs6u/5VMld7Bbg=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["useContext","useEffect","useState","socket","AuthContext","API","jsxDEV","_jsxDEV","Fragment","_Fragment","Chat","_s","user","friends","setFriends","currentFriend","setCurrentFriend","message","setMessage","messages","setMessages","_id","emit","on","senderId","text","prev","off","fetchFriends","res","get","headers","Authorization","localStorage","getItem","data","sendMessage","receiverId","style","display","height","children","width","borderRight","username","fileName","_jsxFileName","lineNumber","columnNumber","map","f","onClick","cursor","background","padding","overflowY","m","i","value","onChange","e","target","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/user/OneDrive/Desktop/cht/client/src/components/Chat.jsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport socket from \"../socket\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport API from \"../api\";\r\n\r\nexport default function Chat() {\r\n  const { user } = useContext(AuthContext);\r\n\r\n  const [friends, setFriends] = useState([]);\r\n  const [currentFriend, setCurrentFriend] = useState(null);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [messages, setMessages] = useState({}); // ðŸ‘ˆ per friend\r\n\r\n  // JOIN SOCKET ROOM\r\n  useEffect(() => {\r\n    if (user?._id) {\r\n      socket.emit(\"join\", user._id);\r\n    }\r\n  }, [user]);\r\n\r\n  // RECEIVE MESSAGE\r\n  useEffect(() => {\r\n    socket.on(\"receiveMessage\", ({ senderId, text }) => {\r\n      setMessages(prev => ({\r\n        ...prev,\r\n        [senderId]: [...(prev[senderId] || []), { senderId, text }]\r\n      }));\r\n    });\r\n\r\n    return () => socket.off(\"receiveMessage\");\r\n  }, []);\r\n\r\n  // FETCH FRIENDS\r\n  useEffect(() => {\r\n    const fetchFriends = async () => {\r\n      const res = await API.get(\"/users\", {\r\n        headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` }\r\n      });\r\n      setFriends(res.data);\r\n    };\r\n    fetchFriends();\r\n  }, []);\r\n\r\n  // SEND MESSAGE\r\n  const sendMessage = () => {\r\n    if (!currentFriend || !message) return;\r\n\r\n    socket.emit(\"sendMessage\", {\r\n      senderId: user._id,\r\n      receiverId: currentFriend._id,\r\n      text: message\r\n    });\r\n\r\n    setMessages(prev => ({\r\n      ...prev,\r\n      [currentFriend._id]: [\r\n        ...(prev[currentFriend._id] || []),\r\n        { senderId: user._id, text: message }\r\n      ]\r\n    }));\r\n\r\n    setMessage(\"\");\r\n  };\r\n\r\n  return (\r\n    <div style={{ display: \"flex\", height: \"90vh\" }}>\r\n      \r\n      {/* FRIEND LIST */}\r\n      <div style={{ width: \"30%\", borderRight: \"1px solid #ccc\" }}>\r\n        <h3>{user.username}</h3>\r\n        {friends.map(f => (\r\n          <p\r\n            key={f._id}\r\n            onClick={() => setCurrentFriend(f)}\r\n            style={{\r\n              cursor: \"pointer\",\r\n              background: currentFriend?._id === f._id ? \"#eee\" : \"transparent\"\r\n            }}\r\n          >\r\n            {f.username}\r\n          </p>\r\n        ))}\r\n      </div>\r\n\r\n      {/* CHAT AREA */}\r\n      <div style={{ width: \"70%\", padding: \"10px\" }}>\r\n        {currentFriend ? (\r\n          <>\r\n            <h3>Chat with {currentFriend.username}</h3>\r\n\r\n            <div style={{ height: \"70vh\", overflowY: \"auto\" }}>\r\n              {(messages[currentFriend._id] || []).map((m, i) => (\r\n                <p key={i}>\r\n                  <b>{m.senderId === user._id ? \"You\" : currentFriend.username}:</b>\r\n                  {\" \"}{m.text}\r\n                </p>\r\n              ))}\r\n            </div>\r\n\r\n            <input\r\n              value={message}\r\n              onChange={e => setMessage(e.target.value)}\r\n              placeholder=\"Type message...\"\r\n            />\r\n            <button onClick={sendMessage}>Send</button>\r\n          </>\r\n        ) : (\r\n          <h3>Select a friend to start chatting</h3>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}