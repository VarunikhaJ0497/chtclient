{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\OneDrive\\\\Desktop\\\\cht\\\\client\\\\src\\\\components\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from \"react\";\nimport socket from \"../socket\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport API from \"../api\";\nimport \"./Chat.css\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const {\n    user\n  } = useContext(AuthContext);\n  const [friends, setFriends] = useState([]);\n  const [currentFriend, setCurrentFriend] = useState(null);\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState({});\n  const [onlineUsers, setOnlineUsers] = useState([]);\n\n  // JOIN SOCKET ROOM\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user._id) {\n      socket.emit(\"join\", user._id);\n    }\n  }, [user]);\n\n  // RECEIVE ONLINE USERS\n  useEffect(() => {\n    socket.on(\"onlineUsers\", users => {\n      setOnlineUsers(users);\n    });\n    return () => socket.off(\"onlineUsers\");\n  }, []);\n\n  // RECEIVE MESSAGE\n  useEffect(() => {\n    socket.on(\"receiveMessage\", ({\n      senderId,\n      text\n    }) => {\n      setMessages(prev => ({\n        ...prev,\n        [senderId]: [...(prev[senderId] || []), {\n          senderId,\n          text\n        }]\n      }));\n    });\n    return () => socket.off(\"receiveMessage\");\n  }, []);\n\n  // FETCH FRIENDS\n  useEffect(() => {\n    const fetchFriends = async () => {\n      const res = await API.get(\"/users\", {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setFriends(res.data);\n    };\n    fetchFriends();\n  }, []);\n  const sendMessage = () => {\n    if (!currentFriend || !message) return;\n    socket.emit(\"sendMessage\", {\n      senderId: user._id,\n      receiverId: currentFriend._id,\n      text: message\n    });\n    setMessages(prev => ({\n      ...prev,\n      [currentFriend._id]: [...(prev[currentFriend._id] || []), {\n        senderId: user._id,\n        text: message\n      }]\n    }));\n    setMessage(\"\");\n  };\n  const isOnline = id => onlineUsers.includes(id);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"friends\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: user.username\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), friends.map(f => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `friend ${(currentFriend === null || currentFriend === void 0 ? void 0 : currentFriend._id) === f._id ? \"active\" : \"\"}`,\n        onClick: () => setCurrentFriend(f),\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: `status ${isOnline(f._id) ? \"online\" : \"offline\"}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }, this), f.username]\n      }, f._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-box\",\n      children: currentFriend ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Chat with \", currentFriend.username]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"messages\",\n          children: (messages[currentFriend._id] || []).map((m, i) => /*#__PURE__*/_jsxDEV(\"p\", {\n            className: m.senderId === user._id ? \"me\" : \"them\",\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: [m.senderId === user._id ? \"You\" : currentFriend.username, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 19\n            }, this), \" \", m.text]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"input-box\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            value: message,\n            onChange: e => setMessage(e.target.value),\n            placeholder: \"Type a message...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: sendMessage,\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Select a friend to start chatting\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"7eo+m1Xwxx0YE5khH327Fk/qdyo=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["useContext","useEffect","useState","socket","AuthContext","API","jsxDEV","_jsxDEV","Fragment","_Fragment","Chat","_s","user","friends","setFriends","currentFriend","setCurrentFriend","message","setMessage","messages","setMessages","onlineUsers","setOnlineUsers","_id","emit","on","users","off","senderId","text","prev","fetchFriends","res","get","headers","Authorization","localStorage","getItem","data","sendMessage","receiverId","isOnline","id","includes","className","children","username","fileName","_jsxFileName","lineNumber","columnNumber","map","f","onClick","m","i","value","onChange","e","target","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/user/OneDrive/Desktop/cht/client/src/components/Chat.jsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport socket from \"../socket\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport API from \"../api\";\r\nimport \"./Chat.css\";\r\n\r\nexport default function Chat() {\r\n  const { user } = useContext(AuthContext);\r\n\r\n  const [friends, setFriends] = useState([]);\r\n  const [currentFriend, setCurrentFriend] = useState(null);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [messages, setMessages] = useState({});\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n\r\n  // JOIN SOCKET ROOM\r\n  useEffect(() => {\r\n    if (user?._id) {\r\n      socket.emit(\"join\", user._id);\r\n    }\r\n  }, [user]);\r\n\r\n  // RECEIVE ONLINE USERS\r\n  useEffect(() => {\r\n    socket.on(\"onlineUsers\", (users) => {\r\n      setOnlineUsers(users);\r\n    });\r\n\r\n    return () => socket.off(\"onlineUsers\");\r\n  }, []);\r\n\r\n  // RECEIVE MESSAGE\r\n  useEffect(() => {\r\n    socket.on(\"receiveMessage\", ({ senderId, text }) => {\r\n      setMessages(prev => ({\r\n        ...prev,\r\n        [senderId]: [...(prev[senderId] || []), { senderId, text }]\r\n      }));\r\n    });\r\n\r\n    return () => socket.off(\"receiveMessage\");\r\n  }, []);\r\n\r\n  // FETCH FRIENDS\r\n  useEffect(() => {\r\n    const fetchFriends = async () => {\r\n      const res = await API.get(\"/users\", {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\r\n        }\r\n      });\r\n      setFriends(res.data);\r\n    };\r\n    fetchFriends();\r\n  }, []);\r\n\r\n  const sendMessage = () => {\r\n    if (!currentFriend || !message) return;\r\n\r\n    socket.emit(\"sendMessage\", {\r\n      senderId: user._id,\r\n      receiverId: currentFriend._id,\r\n      text: message\r\n    });\r\n\r\n    setMessages(prev => ({\r\n      ...prev,\r\n      [currentFriend._id]: [\r\n        ...(prev[currentFriend._id] || []),\r\n        { senderId: user._id, text: message }\r\n      ]\r\n    }));\r\n\r\n    setMessage(\"\");\r\n  };\r\n\r\n  const isOnline = (id) => onlineUsers.includes(id);\r\n\r\n  return (\r\n    <div className=\"chat-container\">\r\n      \r\n      {/* FRIEND LIST */}\r\n      <div className=\"friends\">\r\n        <h3>{user.username}</h3>\r\n\r\n        {friends.map(f => (\r\n          <div\r\n            key={f._id}\r\n            className={`friend ${currentFriend?._id === f._id ? \"active\" : \"\"}`}\r\n            onClick={() => setCurrentFriend(f)}\r\n          >\r\n            <span className={`status ${isOnline(f._id) ? \"online\" : \"offline\"}`}></span>\r\n            {f.username}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* CHAT AREA */}\r\n      <div className=\"chat-box\">\r\n        {currentFriend ? (\r\n          <>\r\n            <h3>Chat with {currentFriend.username}</h3>\r\n\r\n            <div className=\"messages\">\r\n              {(messages[currentFriend._id] || []).map((m, i) => (\r\n                <p key={i} className={m.senderId === user._id ? \"me\" : \"them\"}>\r\n                  <b>{m.senderId === user._id ? \"You\" : currentFriend.username}:</b>{\" \"}\r\n                  {m.text}\r\n                </p>\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"input-box\">\r\n              <input\r\n                value={message}\r\n                onChange={e => setMessage(e.target.value)}\r\n                placeholder=\"Type a message...\"\r\n              />\r\n              <button onClick={sendMessage}>Send</button>\r\n            </div>\r\n          </>\r\n        ) : (\r\n          <h3>Select a friend to start chatting</h3>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}